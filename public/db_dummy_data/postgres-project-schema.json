{
  "metadata": {
    "dialect": "postgresql",
    "version": "1.0"
  },
  "tables": [
    {
      "name": "organizations",
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "nullable": false,
          "primary_key": true,
          "auto_increment": true
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "slug",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        }
      ]
    },
    {
      "name": "users",
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "nullable": false,
          "primary_key": true,
          "auto_increment": true
        },
        {
          "name": "organization_id",
          "type": "integer",
          "nullable": false
        },
        {
          "name": "email",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "full_name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "role",
          "type": "varchar(20)",
          "nullable": false,
          "default": "'member'"
        },
        {
          "name": "active",
          "type": "boolean",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "created_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        }
      ],
      "foreign_keys": [
        {
          "name": "fk_users_organization_id",
          "column": "organization_id",
          "references": {
            "table": "organizations",
            "column": "id"
          },
          "on_delete": "CASCADE",
          "on_update": "CASCADE"
        }
      ]
    },
    {
      "name": "projects",
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "nullable": false,
          "primary_key": true,
          "auto_increment": true
        },
        {
          "name": "organization_id",
          "type": "integer",
          "nullable": false
        },
        {
          "name": "name",
          "type": "varchar(200)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "status",
          "type": "varchar(20)",
          "nullable": false,
          "default": "'planning'"
        },
        {
          "name": "start_date",
          "type": "date",
          "nullable": true
        },
        {
          "name": "end_date",
          "type": "date",
          "nullable": true
        },
        {
          "name": "created_by",
          "type": "integer",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        },
        {
          "name": "updated_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        }
      ],
      "foreign_keys": [
        {
          "name": "fk_projects_organization_id",
          "column": "organization_id",
          "references": {
            "table": "organizations",
            "column": "id"
          },
          "on_delete": "CASCADE",
          "on_update": "CASCADE"
        },
        {
          "name": "fk_projects_created_by",
          "column": "created_by",
          "references": {
            "table": "users",
            "column": "id"
          },
          "on_delete": "RESTRICT",
          "on_update": "CASCADE"
        }
      ]
    },
    {
      "name": "tasks",
      "columns": [
        {
          "name": "id",
          "type": "bigint",
          "nullable": false,
          "primary_key": true,
          "auto_increment": true
        },
        {
          "name": "project_id",
          "type": "integer",
          "nullable": false
        },
        {
          "name": "title",
          "type": "varchar(200)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "status",
          "type": "varchar(20)",
          "nullable": false,
          "default": "'todo'"
        },
        {
          "name": "priority",
          "type": "integer",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "assigned_to",
          "type": "integer",
          "nullable": true
        },
        {
          "name": "due_date",
          "type": "date",
          "nullable": true
        },
        {
          "name": "completed_at",
          "type": "timestamp",
          "nullable": true
        },
        {
          "name": "created_by",
          "type": "integer",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        },
        {
          "name": "updated_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        }
      ],
      "foreign_keys": [
        {
          "name": "fk_tasks_project_id",
          "column": "project_id",
          "references": {
            "table": "projects",
            "column": "id"
          },
          "on_delete": "CASCADE",
          "on_update": "CASCADE"
        },
        {
          "name": "fk_tasks_assigned_to",
          "column": "assigned_to",
          "references": {
            "table": "users",
            "column": "id"
          },
          "on_delete": "SET NULL",
          "on_update": "CASCADE"
        },
        {
          "name": "fk_tasks_created_by",
          "column": "created_by",
          "references": {
            "table": "users",
            "column": "id"
          },
          "on_delete": "RESTRICT",
          "on_update": "CASCADE"
        }
      ]
    },
    {
      "name": "task_comments",
      "columns": [
        {
          "name": "id",
          "type": "bigint",
          "nullable": false,
          "primary_key": true,
          "auto_increment": true
        },
        {
          "name": "task_id",
          "type": "bigint",
          "nullable": false
        },
        {
          "name": "user_id",
          "type": "integer",
          "nullable": false
        },
        {
          "name": "comment",
          "type": "text",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        }
      ],
      "foreign_keys": [
        {
          "name": "fk_task_comments_task_id",
          "column": "task_id",
          "references": {
            "table": "tasks",
            "column": "id"
          },
          "on_delete": "CASCADE",
          "on_update": "CASCADE"
        },
        {
          "name": "fk_task_comments_user_id",
          "column": "user_id",
          "references": {
            "table": "users",
            "column": "id"
          },
          "on_delete": "CASCADE",
          "on_update": "CASCADE"
        }
      ]
    }
  ]
}